# üöÄ WhatsApp Bot v2.0 - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### üóëÔ∏è –£–¥–∞–ª–µ–Ω–æ
- ‚ùå **@green-api/whatsapp-chatgpt** - –º–æ–¥—É–ª—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—ë–Ω (–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª –ø—Ä–æ–∫—Å–∏)
- ‚ùå **chatRobot.js** - —Ñ–∞–π–ª —É–¥–∞–ª—ë–Ω (–¥—É–±–ª–∏—Ä–æ–≤–∞–ª —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)
- ‚ùå 11 –ª–∏—à–Ω–∏—Ö npm –ø–∞–∫–µ—Ç–æ–≤

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ
- ‚úÖ **–ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ OpenAI API** (–∫–∞–∫ –≤ –≤–∞—à–µ–º PHP –ø—Ä–∏–º–µ—Ä–µ)
- ‚úÖ **SOCKS5 –ø—Ä–æ–∫—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç** –¥–ª—è –≤—Å–µ—Ö OpenAI –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ **–£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ

### üîÑ –ò–∑–º–µ–Ω–µ–Ω–æ
- ‚úÖ **botRunner.js** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Å OpenAI API
- ‚úÖ **package.json** - –≤–µ—Ä—Å–∏—è 2.0.0, —É–¥–∞–ª–µ–Ω—ã –ª–∏—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ **README.md** - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ v2.0

```
WhatsApp ‚Üê Green API ‚Üê botRunner.js ‚Üê [responseAnalyzer.js, objectionHandler.js]
                                       ‚Üì
                                  proxyConfig.js (SOCKS5)
                                       ‚Üì
                                  OpenAI API (GPT-4o)
```

**–ê–Ω–∞–ª–æ–≥–∏—è —Å –≤–∞—à–∏–º PHP –∫–æ–¥–æ–º:**

| PHP | Node.js v2.0 |
|-----|--------------|
| `curl_setopt($ch, CURLOPT_PROXY, '45.81.35.40:1080')` | `proxyConfig.js` - —Å–æ–∑–¥–∞—ë—Ç SocksProxyAgent |
| `curl_setopt($ch, CURLOPT_PROXYTYPE, CURLPROXY_SOCKS5)` | `new SocksProxyAgent('socks5://...')` |
| `curl_exec($ch)` | `openai.chat.completions.create()` —Å httpAgent |

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –®–∞–≥ 1: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ .env –µ—Å—Ç—å –ø—Ä–æ–∫—Å–∏
```env
# OpenAI
OPENAI_API_KEY=your_key_here

# SOCKS5 Proxy
PROXY_HOST=45.81.35.40
PROXY_PORT=1080

# Green API
ID_INSTANCE=your_instance
API_TOKEN_INSTANCE=your_token

# Database
DB_HOST=localhost
DB_USER=your_user
DB_PASSWORD=your_password
DB_NAME=whatsappbot
```

### –®–∞–≥ 2: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ä—ã–π –±–æ—Ç (–µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω)
```bash
pm2 stop whatsappbot
```

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
npm install
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç
```bash
pm2 start ecosystem.config.cjs
```

–∏–ª–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```bash
npm start
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
```bash
pm2 logs whatsappbot --lines 50
```

**–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:**
```
‚úÖ SOCKS5 –ø—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω: 45.81.35.40:1080
üåê –í–µ–±-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:3000
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –¢–µ—Å—Ç 1: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
1. –û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:3000
2. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞: `79034340422`
3. –í–≤–µ–¥–∏—Ç–µ ID –æ–±—ä–µ–∫—Ç–∞: `1`
4. –ù–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞"

### –¢–µ—Å—Ç 2: –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ WhatsApp.

**–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≤ –ª–æ–≥–∞—Ö:**
```
‚úÖ SOCKS5 –ø—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω: 45.81.35.40:1080
[12:37:18] –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç 79034340422@c.us: –î–æ–±—Ä—ã–π –¥–µ–Ω—å...
‚ÑπÔ∏è –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–µ–º: "–î–æ–±—Ä—ã–π –¥–µ–Ω—å..."
[12:37:18] –ê–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–∞: –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π
[12:37:20] –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ 79034340422@c.us: –•–æ—Ä–æ—à–æ, —Å–ø–∞—Å–∏–±–æ...
```

**–ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
‚ùå –û—à–∏–±–∫–∞: 403 Country, region, or territory not supported
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (v2.0)

```
WhatsAppBot/
‚îú‚îÄ‚îÄ server.js                 # –í–µ–±-—Å–µ—Ä–≤–µ—Ä (API endpoints)
‚îú‚îÄ‚îÄ botRunner.js              # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ objectionHandler.js       # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π + OpenAI RAG
‚îú‚îÄ‚îÄ responseAnalyzer.js       # –ê–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ + OpenAI
‚îú‚îÄ‚îÄ proxyConfig.js            # SOCKS5 –ø—Ä–æ–∫—Å–∏ –¥–ª—è OpenAI
‚îú‚îÄ‚îÄ databaseConnect.js        # MySQL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ formatterName.js          # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º—ë–Ω
‚îú‚îÄ‚îÄ testObjectionHandler.js   # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ index.html                # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ package.json              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (6 –ø–∞–∫–µ—Ç–æ–≤)
‚îî‚îÄ‚îÄ CHANGELOG_V2.md           # –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

## üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ–∫—Å–∏ (–∞–Ω–∞–ª–æ–≥–∏—è —Å PHP)

### –í–∞—à PHP –∫–æ–¥:
```php
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'https://api.openai.com/v1/chat/completions');
curl_setopt($ch, CURLOPT_PROXY, '45.81.35.40:1080');
curl_setopt($ch, CURLOPT_PROXYTYPE, CURLPROXY_SOCKS5);
$response = curl_exec($ch);
```

### Node.js v2.0:

```1:23:proxyConfig.js
import 'dotenv/config';
import { SocksProxyAgent } from 'socks-proxy-agent';
import https from 'https';

/**
 * –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SOCKS5 –ø—Ä–æ–∫—Å–∏ –¥–ª—è OpenAI API
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
 */

/**
 * –°–æ–∑–¥–∞–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTTP Agent —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ SOCKS5 –ø—Ä–æ–∫—Å–∏
 * @returns {https.Agent|undefined} - Configured proxy agent or undefined if no proxy configured
 */
export function createProxyAgent() {
    const proxyHost = process.env.PROXY_HOST;
    const proxyPort = process.env.PROXY_PORT;

    // –ï—Å–ª–∏ –ø—Ä–æ–∫—Å–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º undefined (–±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)
    if (!proxyHost || !proxyPort) {
        console.log('‚ö†Ô∏è –ü—Ä–æ–∫—Å–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ OpenAI API');
        return undefined;
    }
```

```1:6:responseAnalyzer.js
import 'dotenv/config';
import OpenAI from 'openai';
import { getOpenAIConfig } from './proxyConfig.js';

// –°–æ–∑–¥–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π OpenAI –∫–ª–∏–µ–Ω—Ç —Å –ø—Ä–æ–∫—Å–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–≤–µ—Ç–æ–≤
const openaiClient = new OpenAI(getOpenAIConfig(process.env.OPENAI_API_KEY));
```

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ v2.0

| –ü–∞—Ä–∞–º–µ—Ç—Ä | v1.x | v2.0 |
|----------|------|------|
| OpenAI –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ | –ß–µ—Ä–µ–∑ WhatsappGptBot | ‚úÖ –ù–∞–ø—Ä—è–º—É—é (–∫–∞–∫ –≤ PHP) |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∫—Å–∏ | ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞–ª–∞ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (SOCKS5) |
| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | 7 –ø–∞–∫–µ—Ç–æ–≤ | 6 –ø–∞–∫–µ—Ç–æ–≤ (-1) |
| Node modules | 254 –ø–∞–∫–µ—Ç–∞ | 243 –ø–∞–∫–µ—Ç–∞ (-11) |
| –°–ª–æ–∂–Ω–æ—Å—Ç—å | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω—è—è |
| –ö–æ–Ω—Ç—Ä–æ–ª—å | –ß–∞—Å—Ç–∏—á–Ω—ã–π | ‚úÖ –ü–æ–ª–Ω—ã–π |

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–æ–∫—Å–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ–∫—Å–∏
telnet 45.81.35.40 1080

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª
cat .env | grep PROXY
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ 403
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ .env
echo "PROXY_HOST=45.81.35.40" >> .env
echo "PROXY_PORT=1080" >> .env

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
pm2 restart whatsappbot
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°—Ç–∞—Ä—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
# –£–¥–∞–ª–∏—Ç–µ node_modules –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ
rm -rf node_modules
npm install
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **CHANGELOG_V2.md** - –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **README.md** - –û–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **package.json** - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –∑–∞–ø—É—Å–∫–∞

- [ ] .env —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω (PROXY_HOST, PROXY_PORT, OPENAI_API_KEY)
- [ ] `npm install` –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] –°—Ç–∞—Ä—ã–π –±–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (`pm2 stop whatsappbot`)
- [ ] –ù–æ–≤—ã–π –±–æ—Ç –∑–∞–ø—É—â–µ–Ω (`pm2 start ecosystem.config.cjs`)
- [ ] –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ: `‚úÖ SOCKS5 –ø—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω`
- [ ] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç–∞–µ—Ç: http://localhost:3000
- [ ] –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ 403

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –≤–∞—à –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å OpenAI API **–Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ SOCKS5 –ø—Ä–æ–∫—Å–∏**, 
—Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ –∫–∞–∫ –≤ –≤–∞—à–µ–º PHP –∫–æ–¥–µ!

---

**–í–µ—Ä—Å–∏—è**: 2.0.0  
**–î–∞—Ç–∞**: 30 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç

